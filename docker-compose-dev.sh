#!/bin/bash

# -----------------------------------------------------------------------------
# Exit on any errors
set -e
print() {
cat <<EOF
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
$1
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
EOF
}
cat <<EOF
################################################################################
                $0
################################################################################
EOF
# -----------------------------------------------------------------------------






# -----------------------------------------------------------------------------
# RECREATE node_modules
# NPM Install dependencies locally
# RUN docker-compose for dev stage
# clean
find . -name 'node_modules' -exec rm -rfv {} \;
find . -type f -name "package-lock.json" -exec rm -fv {} \; 

# install
cd app
npm install
cd ..
docker-compose -f ./app/docker-compose-dev.yml up --build

# Test with
# curl --location --request GET 'http://localhost:8080/hello/pt' | jq
# -----------------------------------------------------------------------------







# -----------------------------------------------------------------------------
cat <<EOF
################################################################################
        End of $0
################################################################################
EOF
